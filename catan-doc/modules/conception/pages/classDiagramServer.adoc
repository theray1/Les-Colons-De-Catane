@startuml
package server {
    package core {
        package game {
        	   interface Player{}
            interface GameFacade {
	        	start() : void
	        	end() : void
	        	endPlayer() : void
	        	trade(Player, Resource[], Player, Resource[]) : void
	        	addResourcesTo(Player, Resource[]) : void
	        	removeResourcesTo(Player, Resource[]) : void
            }
        }
        package commands {
            interface CommandGameFactory {
            	createCommand_ActivateThieve(Player[]) : Command
            	createCommand_MoveThieve(Player[], Coordinates) : Command
            	createCommand_Ping(Player[]) : Command
            	createCommand_Build(Player[], Building) : Command
            	createCommand_ActiveCard(Player[], Card) : Command
            	createCommand_AddCard(Player[], Player, Integer) : Command
            	createCommand_BuyCard(Player[], Resource[]) : Command
            	createCommand_EndTour(Player[], Player) : Command
            	createCommand_Win(Player[]) : Command
            	createCommand_SetResources(Player) : Command
            	createCommand_AddResources(Player[], Player, Integer) : Command
            	createCommand_TradeWithNonPlayerEntity(Player, Resource[], Resource[] ) : Command
            	createCommand_TradeWithPlayer(Player, Resource[], Player, Resource[]) : Command
            	createCommand_DenyTrade(Player, Player) : Command
            	createCommand_AcceptTrade(Player, Player) : Command
            	createCommand_LoginComplete(Player) : Command
            	createCommand_SetGame(Player[]) : Command
            	createCommand_SetPlayer(Player) : Command
            }
            interface Command {
                execute(): void
                getRecipients() : Player[]
            }

            interface Serializer {
                serialize(Command): String
                deSerialize(String): Command
            }
        }

        package networking {
            interface ConnectionHandler {
                Broadcast(Command): void
                sendCommand(Command): void
                isEnabled(): Boolean
                addParticipant(Login, Player) : void
            }
        }

        package controler {
            interface NetworkControler {
            	sendCommand(Command) : void
            	addParticipant(Login, Player) : void
            }
            note right: Network management "module"

            interface GameControler {
                receiveCommand(Command): void
                addParticipant(Login, Player) : void
                addPlayer() : Player
            }

        }

    }
      
    package serverImpl {
        package commandsImpl {
            class SerializerImpl <<Serializer>>{}
            abstract CommandAbstract <<CommandGameFactory>>{}
            note bottom : Represent all types of commands.
            class CommandGameFactoryImpl <<CommandGameFactory>>{}
            CommandAbstract *-- "1-4"  Player
        }

        package networkingImpl {
            class WebSocketAdapterImpl <<ConnectionHandler>>{
               links : Map[key: gameImpl.Player][value: Socket]
            }
            class NetworkControlerImpl <<NetworkControler>>{}
            
            NetworkControlerImpl *-up- ConnectionHandler
		   
        }
        package controlerImpl {
        
	        Enum Status{
        	   		NOTSTARTED
        	   		STARTED
        	   		FINISHED
	        }

            class GameControlerImpl <<GameControler>>{
                players: Player[]
                commands: Command[]
            }
            GameControlerImpl *-up- "1" CommandGameFactory
            GameControlerImpl *-up- "1" NetworkControler
            GameControlerImpl *-up- "1" GameFacade
            GameControlerImpl *-up- "1" Serializer
            GameControlerImpl *-- "1" Status
            
        }
    }
 
    
    package managment{
    	package api{
    		interface CommandLoginFactory{
	    		createCommandLogin(Content) : Command
	    	}
    	}
    	
    	package managmentImpl{
    		class CommandLoginFactoryWebSocket <<CommandLoginFactory>>{}
    		
		    
		    class ServerGameManager{
		    	createParty() : void
		    	insertClient(Command) : void
		    }
			
		    class Server {
		        main(): void
		    }
		    
		    ServerGameManager "1" *-right- "*" GameControler
		    ServerGameManager "1" *-down- "1" CommandLoginFactory
		    Server "1" *-down- "1" ServerGameManager
    	}
    
    }

}
@enduml
